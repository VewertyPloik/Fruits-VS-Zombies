<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fruits vs Zombies</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background-color: #d0f0c0;
      margin: 0;
      overflow: hidden;
    }
    #game {
      display: grid;
      grid-template-columns: repeat(9, 64px);
      grid-template-rows: repeat(8, 64px);
      margin: 20px auto;
      background-color: #228B22;
      border: 4px solid #654321;
      position: relative;
    }
    .cell {
      width: 64px;
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      border: 1px solid #000;
      background-color: #7CFC00;
      position: relative;
    }
    .brown {
      background-color: #8B4513;
    }
    .sun {
      position: absolute;
      font-size: 32px;
      cursor: pointer;
      animation: fall 4s linear forwards;
    }
    @keyframes fall {
      from { top: 0; }
      to { top: 100%; }
    }
    .zombie {
      position: absolute;
      font-size: 32px;
      transition: left 1s linear;
    }
    .bullet {
      position: absolute;
      font-size: 20px;
      transition: left 0.2s linear;
    }
    #ui {
      margin-top: 10px;
    }
    button {
      font-size: 16px;
      margin: 5px;
    }
  </style>
</head>
<body>
  <h1>Fruits vs Zombies</h1>
  <div id="ui">
    <span id="health">Health: 25</span> |
    <span id="sunCoins">Sun Coins: 10</span> |
    <span id="score">Score: 0</span>
    <br>
    <button onclick="selectedPlant='banana'">Buy üçå (5)</button>
    <button onclick="selectedPlant='apple'">Buy üçé (5)</button>
  </div>
  <div id="game"></div>

  <script>
    const gridRows = 8;
    const gridCols = 9;
    const greenCols = 8;
    const cellSize = 64;

    let grid = [];
    let sunCoins = 10;
    let health = 25;
    let score = 0;
    let highScore = 0;
    let zombies = [];
    let bullets = [];
    let timeSurvived = 0;
    let gameInterval;
    let gameOver = false;
    let selectedPlant = 'banana';

    const gameEl = document.getElementById('game');

    class Zombie {
      constructor(row, hp, speed) {
        this.row = row;
        this.hp = hp;
        this.speed = speed;
        this.col = gridCols - 1;
        this.el = document.createElement('div');
        this.el.className = 'zombie';
        this.el.textContent = 'üßü';
        gameEl.appendChild(this.el);
        this.updatePosition();
      }
      move() {
        this.col--;
        this.updatePosition();
      }
      updatePosition() {
        this.el.style.top = `${this.row * cellSize}px`;
        this.el.style.left = `${this.col * cellSize}px`;
      }
      remove() {
        this.el.remove();
      }
    }

    class Bullet {
      constructor(row, col) {
        this.row = row;
        this.col = col;
        this.el = document.createElement('div');
        this.el.className = 'bullet';
        this.el.textContent = 'üî¥';
        this.el.style.top = `${row * cellSize + 20}px`;
        this.el.style.left = `${col * cellSize + 30}px`;
        gameEl.appendChild(this.el);
      }
      move() {
        this.col++;
        this.el.style.left = `${this.col * cellSize + 30}px`;
      }
      remove() {
        this.el.remove();
      }
    }

    function setupGrid() {
      gameEl.innerHTML = '';
      grid = [];
      for (let r = 0; r < gridRows; r++) {
        const row = [];
        for (let c = 0; c < gridCols; c++) {
          const cell = document.createElement('div');
          cell.className = 'cell';
          if (c === gridCols - 1) cell.classList.add('brown');
          cell.dataset.row = r;
          cell.dataset.col = c;
          cell.onclick = () => buyPlant(selectedPlant, r, c);
          gameEl.appendChild(cell);
          row.push(null);
        }
        grid.push(row);
      }
    }

    function renderGrid() {
      const cells = document.querySelectorAll('.cell');
      cells.forEach(cell => {
        const row = +cell.dataset.row;
        const col = +cell.dataset.col;
        const content = grid[row][col];
        if (content === 'banana') cell.textContent = 'üçå';
        else if (content === 'apple') cell.textContent = 'üçé';
        else cell.textContent = '';
      });
    }

    function updateUI() {
      document.getElementById('health').textContent = `Health: ${health}`;
      document.getElementById('sunCoins').textContent = `Sun Coins: ${sunCoins}`;
      document.getElementById('score').textContent = `Score: ${score}`;
    }

    function spawnZombie() {
      const row = Math.floor(Math.random() * gridRows);
      if (Math.random() > 0.5) return; // less zombies
      let speed = 1000 - Math.floor(timeSurvived / 10) * 100;
      if (speed < 400) speed = 400;
      const hp = 10 + Math.floor(timeSurvived / 10) * 10;
      const z = new Zombie(row, hp, speed);
      zombies.push(z);
    }

    function spawnSun() {
      const sun = document.createElement('div');
      sun.textContent = '‚òÄÔ∏è';
      sun.className = 'sun';
      sun.style.left = `${Math.random() * (gridCols * cellSize - 40)}px`;
      sun.onclick = () => {
        sun.remove();
        sunCoins++;
        updateUI();
      };
      gameEl.appendChild(sun);
      setTimeout(() => sun.remove(), 4000);
    }

    function shootBullets() {
      for (let r = 0; r < gridRows; r++) {
        for (let c = 0; c < greenCols; c++) {
          if (grid[r][c] === 'apple') {
            const b = new Bullet(r, c);
            bullets.push(b);
          }
        }
      }
    }

    function updateBullets() {
      bullets.forEach((b, i) => {
        b.move();
        zombies.forEach((z, zi) => {
          if (z.row === b.row && z.col === b.col) {
            z.hp -= 10;
            if (z.hp <= 0) {
              z.remove();
              zombies.splice(zi, 1);
            }
            b.remove();
            bullets.splice(i, 1);
          }
        });
        if (b.col >= gridCols) {
          b.remove();
          bullets.splice(i, 1);
        }
      });
    }

    function moveZombies() {
      zombies.forEach((z, i) => {
        z.move();
        if (z.col < 0) {
          z.remove();
          zombies.splice(i, 1);
          health--;
          updateUI();
          if (health <= 0) endGame();
        }
      });
    }

    function buyPlant(type, row, col) {
      if (sunCoins < 5 || col >= greenCols) return;
      if (grid[row][col] !== null) return;
      grid[row][col] = type;
      sunCoins -= 5;
      updateUI();
      renderGrid();
    }

    function endGame() {
      gameOver = true;
      if (score > highScore) highScore = score;
      alert(`You died!\nScore: ${score}\nHigh Score: ${highScore}`);
      location.reload();
    }

    function updateGame() {
      if (gameOver) return;
      timeSurvived++;
      score++;
      updateUI();
      moveZombies();
      updateBullets();
    }

    function startGame() {
      setupGrid();
      updateUI();
      renderGrid();
      gameInterval = setInterval(updateGame, 1000);
      setInterval(spawnZombie, 3000);
      setInterval(spawnSun, 2000);
      setInterval(shootBullets, 3000);
    }

    startGame();
  </script>
</body>
</html>
