<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fruits vs Zombies</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background-color: #d0f0c0;
      margin: 0;
    }
    #game {
      display: grid;
      grid-template-columns: repeat(9, 64px);
      grid-template-rows: repeat(8, 64px);
      margin: 20px auto;
      background-color: #228B22;
      border: 4px solid #654321;
    }
    .cell {
      width: 64px;
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      border: 1px solid #000;
      background-color: #7CFC00;
    }
    .brown {
      background-color: #8B4513;
    }
    #ui {
      margin-top: 10px;
    }
    button {
      font-size: 16px;
      margin: 5px;
    }
  </style>
</head>
<body>
  <h1>Fruits vs Zombies</h1>
  <div id="ui">
    <span id="health">Health: 25</span> |
    <span id="sunCoins">Sun Coins: 10</span> |
    <span id="score">Score: 0</span>
    <br>
    <button onclick="selectedPlant='banana'">Buy üçå (5)</button>
    <button onclick="selectedPlant='apple'">Buy üçé (5)</button>
  </div>
  <div id="game"></div>

  <script>
    const gridRows = 8;
    const gridCols = 9;
    const greenCols = 8;
    let grid = [];
    let sunCoins = 10;
    let health = 25;
    let score = 0;
    let highScore = 0;
    let zombies = [];
    let sunObjects = [];
    let timeSurvived = 0;
    let gameInterval;
    let gameOver = false;
    let selectedPlant = 'banana';

    class Zombie {
      constructor(row, hp, speed) {
        this.row = row;
        this.hp = hp;
        this.speed = speed;
        this.col = gridCols;
        this.lastMoveTime = Date.now();
        this.el = document.createElement('div');
        this.el.textContent = 'üßü';
        this.el.style.position = 'absolute';
        document.body.appendChild(this.el);
      }
      update() {
        if (Date.now() - this.lastMoveTime >= this.speed) {
          this.col--;
          this.lastMoveTime = Date.now();
        }
      }
    }

    function setupGrid() {
      const gameEl = document.getElementById('game');
      gameEl.innerHTML = '';
      grid = [];
      for (let r = 0; r < gridRows; r++) {
        let row = [];
        for (let c = 0; c < gridCols; c++) {
          const cell = document.createElement('div');
          cell.className = 'cell';
          if (c === 8) cell.classList.add('brown');
          cell.dataset.row = r;
          cell.dataset.col = c;
          cell.onclick = () => buyPlant(selectedPlant, r, c);
          gameEl.appendChild(cell);
          row.push(null);
        }
        grid.push(row);
      }
    }

    function renderGrid() {
      const cells = document.querySelectorAll('.cell');
      cells.forEach(cell => {
        const row = +cell.dataset.row;
        const col = +cell.dataset.col;
        const content = grid[row][col];
        if (content === 'banana') cell.textContent = 'üçå';
        else if (content === 'apple') cell.textContent = 'üçé';
        else cell.textContent = '';
      });
      zombies.forEach(z => {
        const idx = z.row * gridCols + z.col;
        if (idx >= 0 && idx < cells.length) cells[idx].textContent = 'üßü';
      });
    }

    function spawnZombie() {
      const row = Math.floor(Math.random() * gridRows);
      let speed = 1000 - Math.floor(timeSurvived / 10) * 100;
      if (speed < 200) speed = 200;
      const hp = 10 + Math.floor(timeSurvived / 10) * 10;
      zombies.push(new Zombie(row, hp, speed));
    }

    function updateGame() {
      if (gameOver) return;
      timeSurvived++;
      score++;
      zombies.forEach(z => z.update());
      checkCollisions();
      updateUI();
      renderGrid();
    }

    function checkCollisions() {
      for (let i = zombies.length - 1; i >= 0; i--) {
        const z = zombies[i];
        if (z.col < 0) {
          health--;
          zombies.splice(i, 1);
          if (health <= 0) endGame();
          continue;
        }
        const cell = grid[z.row][z.col];
        if (cell === 'apple') {
          grid[z.row][z.col] = null;
          zombies.splice(i, 1);
        } else if (cell === 'banana') {
          z.hp -= 10;
          if (z.hp <= 0) zombies.splice(i, 1);
        }
      }
    }

    function spawnSun() {
      const btn = document.createElement('button');
      btn.textContent = '‚òÄÔ∏è';
      btn.style.position = 'absolute';
      btn.style.left = Math.random() * window.innerWidth + 'px';
      btn.style.top = '0px';
      btn.onclick = () => {
        sunCoins++;
        btn.remove();
        updateUI();
      };
      document.body.appendChild(btn);
      setTimeout(() => btn.remove(), 5000);
    }

    function buyPlant(type, row, col) {
      if (sunCoins < 5 || col >= greenCols) return;
      if (grid[row][col] !== null) return;
      grid[row][col] = type;
      sunCoins -= 5;
      updateUI();
      renderGrid();
    }

    function updateUI() {
      document.getElementById('health').textContent = `Health: ${health}`;
      document.getElementById('sunCoins').textContent = `Sun Coins: ${sunCoins}`;
      document.getElementById('score').textContent = `Score: ${score}`;
    }

    function endGame() {
      gameOver = true;
      if (score > highScore) highScore = score;
      alert(`You died!\nScore: ${score}\nHigh Score: ${highScore}`);
      location.reload();
    }

    function startGame() {
      setupGrid();
      updateUI();
      gameInterval = setInterval(updateGame, 1000);
      setInterval(spawnZombie, 2000);
      setInterval(spawnSun, 2000);
    }

    startGame();
  </script>
</body>
</html>
