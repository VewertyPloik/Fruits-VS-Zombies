<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Ghost Hunter - 10x10 Grid</title>
<style>
  body {
    background: #111;
    color: white;
    font-family: monospace, monospace;
    user-select: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  #game {
    margin-top: 20px;
    position: relative;
    width: 500px; /* 10 cells * 50px */
    height: 500px;
    background: #222;
    display: grid;
    grid-template-columns: repeat(10, 1fr);
    grid-template-rows: repeat(10, 1fr);
    gap: 2px;
  }
  .cell {
    background: #333;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 32px;
    position: relative;
  }
  #info {
    margin-top: 15px;
    font-size: 18px;
    text-align: center;
  }
  #healthBarPlayer, #healthBarGhost {
    width: 100px;
    height: 10px;
    background: #444;
    border: 1px solid #666;
    margin: 5px 0;
    position: relative;
    border-radius: 4px;
  }
  #healthPlayerFill, #healthGhostFill {
    height: 100%;
    background: #0f0;
    width: 100%;
    border-radius: 4px;
    transition: width 0.2s ease;
  }
  #healthGhostFill {
    background: #f00;
  }
  #scoreBoard {
    margin-top: 10px;
    font-size: 16px;
  }
  #message {
    margin-top: 10px;
    font-size: 20px;
    color: #ff4444;
    min-height: 30px;
  }
  button {
    margin-top: 10px;
    padding: 12px 20px;
    font-size: 24px;
    cursor: pointer;
    border-radius: 6px;
    border: none;
    background: #555;
    color: white;
    user-select: none;
  }
  button:active {
    background: #888;
  }
  #controls {
    margin-top: 15px;
    display: flex;
    gap: 15px;
  }
  /* Make buttons bigger on mobile */
  @media (max-width: 600px) {
    button {
      padding: 16px 24px;
      font-size: 28px;
    }
  }
  /* Mirror gun emoji horizontally */
  .gun {
    display: inline-block;
    transform: scaleX(-1);
  }
</style>
</head>
<body>

<h1>Ghost Hunter</h1>
<div id="healthBarPlayer" aria-label="Player Health">
  <div id="healthPlayerFill"></div>
</div>
<div id="healthBarGhost" style="display:none;" aria-label="Ghost Health">
  <div id="healthGhostFill"></div>
</div>

<div id="game" aria-label="Game Grid" role="grid" aria-rowcount="10" aria-colcount="10"></div>

<div id="info" aria-live="polite" aria-atomic="true">
  Use Up â–² and Down â–¼ buttons or arrow keys to move.<br />
  Press Shoot ðŸ”« button or Spacebar to shoot.
</div>

<div id="scoreBoard" aria-live="polite">
  Score: <span id="score">0</span> | High Score: <span id="highScore">0</span>
</div>

<div id="message" role="alert" aria-live="assertive"></div>

<div id="controls">
  <button id="btnUp" aria-label="Move Up" title="Move Up">â–²</button>
  <button id="btnDown" aria-label="Move Down" title="Move Down">â–¼</button>
  <button id="btnShoot" aria-label="Shoot" title="Shoot">ðŸ”«</button>
</div>

<button id="restartBtn" style="display:none;">Restart</button>

<script>
(() => {
  const GRID_SIZE = 10;
  const PLAYER_HP_MAX = 25;
  const GHOST_BASE_HP = 10;
  const GUN_DAMAGE = 10;
  const DAMAGE_ON_TOUCH = 5;
  const GHOST_HP_INCREASE_INTERVAL = 10000; // 10 seconds

  const gameEl = document.getElementById('game');
  const healthPlayerFill = document.getElementById('healthPlayerFill');
  const healthGhostFill = document.getElementById('healthGhostFill');
  const healthBarGhost = document.getElementById('healthBarGhost');
  const scoreEl = document.getElementById('score');
  const highScoreEl = document.getElementById('highScore');
  const messageEl = document.getElementById('message');
  const restartBtn = document.getElementById('restartBtn');

  const btnUp = document.getElementById('btnUp');
  const btnDown = document.getElementById('btnDown');
  const btnShoot = document.getElementById('btnShoot');

  let grid = [];
  let player = {
    x: 0,
    y: Math.floor(GRID_SIZE / 2),
    hp: PLAYER_HP_MAX
  };
  let bullets = []; // {x, y}
  let ghosts = []; // only one ghost at a time: {x, y, hp}
  let ghostBaseHp = GHOST_BASE_HP;
  let score = 0;
  let highScore = 0;
  let gameOver = false;
  let lastGhostHpIncreaseTime = 0;

  // Load high score from localStorage
  function loadHighScore() {
    let hs = localStorage.getItem('ghostHunterHighScore');
    if (hs !== null) highScore = parseInt(hs);
    highScoreEl.textContent = highScore;
  }
  function saveHighScore() {
    if (score > highScore) {
      highScore = score;
      localStorage.setItem('ghostHunterHighScore', highScore);
      highScoreEl.textContent = highScore;
    }
  }

  // Create grid cells
  function createGrid() {
    gameEl.innerHTML = '';
    grid = [];
    for(let i = 0; i < GRID_SIZE * GRID_SIZE; i++) {
      const cell = document.createElement('div');
      cell.classList.add('cell');
      gameEl.appendChild(cell);
      grid.push(cell);
    }
  }

  // Get cell index from x,y
  function cellIndex(x,y) {
    return y * GRID_SIZE + x;
  }

  // Draw everything on grid
  function drawGrid() {
    // Clear all cells
    for(let cell of grid) cell.textContent = '';
    healthBarGhost.style.display = 'none';

    // Draw ghosts (only one ghost max)
    if(ghosts.length > 0) {
      let g = ghosts[0];
      if(g.x >= 0 && g.x < GRID_SIZE && g.y >= 0 && g.y < GRID_SIZE) {
        grid[cellIndex(g.x, g.y)].textContent = 'ðŸ‘»';
      }
    }

    // Draw bullets
    for(let b of bullets) {
      if(b.x >= 0 && b.x < GRID_SIZE && b.y >= 0 && b.y < GRID_SIZE) {
        grid[cellIndex(b.x, b.y)].textContent = '-';
      }
    }

    // Draw player with mirrored gun ðŸ”« (gun on right side)
    if(player.x >= 0 && player.x < GRID_SIZE && player.y >= 0 && player.y < GRID_SIZE) {
      grid[cellIndex(player.x, player.y)].textContent = 'ðŸ˜€';
      if(player.x + 1 < GRID_SIZE) {
        // Add gun with mirrored class
        grid[cellIndex(player.x + 1, player.y)].innerHTML = '<span class="gun">ðŸ”«</span>';
      }
    }

    // Show ghost health bar if ghost present
    if(ghosts.length > 0) {
      let firstGhost = ghosts[0];
      healthBarGhost.style.display = 'block';
      const widthPercent = Math.min(100, (firstGhost.hp / ghostBaseHp) * 100);
      healthGhostFill.style.width = widthPercent + '%';
    }
  }

  // Update health bar for player
  function updatePlayerHealthBar() {
    let percent = (player.hp / PLAYER_HP_MAX) * 100;
    healthPlayerFill.style.width = percent + '%';
    if(percent > 60) healthPlayerFill.style.backgroundColor = '#0f0';
    else if(percent > 30) healthPlayerFill.style.backgroundColor = '#ff0';
    else healthPlayerFill.style.backgroundColor = '#f00';
  }

  // Spawn a single ghost if none present
  function spawnGhost() {
    if (ghosts.length === 0) {
      let y = Math.floor(Math.random() * GRID_SIZE);
      ghosts.push({x: GRID_SIZE - 1, y, hp: ghostBaseHp});
    }
  }

  // Move ghosts one step left
  function moveGhosts() {
    for(let g of ghosts) {
      g.x -= 1;
    }
    // Remove ghosts out of left side
    ghosts = ghosts.filter(g => g.x >= 0);
  }

  // Move bullets one step right
  function moveBullets() {
    for(let b of bullets) {
      b.x += 1;
    }
    // Remove bullets out of grid
    bullets = bullets.filter(b => b.x < GRID_SIZE);
  }

  // Handle collisions bullets vs ghosts
  function bulletsHitGhosts() {
    for(let i = bullets.length -1; i >= 0; i--) {
      let b = bullets[i];
      let hitGhostIndex = ghosts.findIndex(g => g.x === b.x && g.y === b.y);
      if(hitGhostIndex !== -1) {
        ghosts[hitGhostIndex].hp -= GUN_DAMAGE;
        bullets.splice(i,1);
        const cell = grid[cellIndex(b.x, b.y)];
        cell.textContent = 'ðŸ’¥';
        setTimeout(() => {
          if(!gameOver) drawGrid();
        }, 150);
        if(ghosts[hitGhostIndex].hp <= 0) {
          ghosts.splice(hitGhostIndex, 1);
          score++;
          scoreEl.textContent = score;
          saveHighScore();
        }
      }
    }
  }

  // Ghosts touch player damage
  function ghostsTouchPlayer() {
    for(let g of ghosts) {
      if(g.x === player.x && g.y === player.y) {
        player.hp -= DAMAGE_ON_TOUCH;
        updatePlayerHealthBar();
        // Remove ghost on touch
        ghosts = ghosts.filter(ghost => ghost !== g);
        if(player.hp <= 0) {
          gameOver = true;
          endGame();
        }
        break;
      }
    }
  }

  // Player movement
  function movePlayer(dx, dy) {
    if(gameOver) return;
    let newX = player.x + dx;
    let newY = player.y + dy;
    if(newX >= 0 && newX < GRID_SIZE && newY >= 0 && newY < GRID_SIZE) {
      player.x = newX;
      player.y = newY;
      drawGrid();
    }
  }

  // Player shooting (creates bullet 1 cell right of gun)
  function playerShoot() {
    if(gameOver) return;
    let bx = player.x + 2;
    let by = player.y;
    if(bx < GRID_SIZE) {
      bullets.push({x: bx, y: by});
      drawGrid();
    }
  }

  // End game handler
  function endGame() {
    saveHighScore();
    messageEl.textContent = `Game Over! Score: ${score} | High Score: ${highScore}`;
    restartBtn.style.display = 'inline-block';
  }

  // Restart game
  function restartGame() {
    player.hp = PLAYER_HP_MAX;
    updatePlayerHealthBar();
    bullets = [];
    ghosts = [];
    score = 0;
    scoreEl.textContent = score;
    ghostBaseHp = GHOST_BASE_HP;
    gameOver = false;
    messageEl.textContent = '';
    restartBtn.style.display = 'none';
    player.x = 0;
    player.y = Math.floor(GRID_SIZE / 2);
    lastGhostHpIncreaseTime = performance.now();
    drawGrid();
  }

  // Game loop variables
  let lastGhostSpawn = 0;
  const GHOST_SPAWN_INTERVAL = 1500; // 1.5 sec

  function gameLoop(timestamp) {
    if(gameOver) return;
    if(!lastGhostSpawn) lastGhostSpawn = timestamp;
    if(!lastGhostHpIncreaseTime) lastGhostHpIncreaseTime = timestamp;

    // Spawn ghost if none on screen and interval passed
    if(ghosts.length === 0 && (timestamp - lastGhostSpawn > GHOST_SPAWN_INTERVAL)) {
      spawnGhost();
      lastGhostSpawn = timestamp;
    }

    // Increase ghost base HP every 10 sec survived
    if(timestamp - lastGhostHpIncreaseTime > GHOST_HP_INCREASE_INTERVAL) {
      ghostBaseHp += 5;
      lastGhostHpIncreaseTime = timestamp;
    }

    moveGhosts();
    moveBullets();
    bulletsHitGhosts();
    ghostsTouchPlayer();

    drawGrid();

    if(!gameOver) requestAnimationFrame(gameLoop);
  }

  // Keyboard controls
  window.addEventListener('keydown', e => {
    if(gameOver) return;
    switch(e.key) {
      case 'ArrowUp':
        movePlayer(0, -1);
        break;
      case 'ArrowDown':
        movePlayer(0, 1);
        break;
      case ' ':
        e.preventDefault();
        playerShoot();
        break;
    }
  });

  // Button controls
  btnUp.addEventListener('click', () => movePlayer(0, -1));
  btnDown.addEventListener('click', () => movePlayer(0, 1));
  btnShoot.addEventListener('click', () => playerShoot());

  restartBtn.addEventListener('click', () => {
    restartGame();
    requestAnimationFrame(gameLoop);
  });

  // Initialize game
  createGrid();
  loadHighScore();
  updatePlayerHealthBar();
  drawGrid();
  requestAnimationFrame(gameLoop);
})();
</script>

</body>
</html>
